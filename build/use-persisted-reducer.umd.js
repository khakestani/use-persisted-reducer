!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("react"),require("universal-cookie")):"function"==typeof define&&define.amd?define(["react","universal-cookie"],t):(e=e||self).usePersistedReducer=t(e.react,e.universalCookie)}(this,function(e,t){t=t&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t;var o="@USE_PERSISTED_REDUCER_SET_FULL_STATE",n=function(e,o,n){console.log("init",o);var r=n instanceof t;try{var i=r?n.get(e,!0):n.getItem(e);return console.log("storageData",i),void 0!==i&&i?r?i:JSON.parse(i):"function"==typeof o?o():void 0!==o?o:{}}catch(e){return console.log("Error --\x3e Getting storage data : ",e),o}};return function(r,i,a,c,s){void 0===c&&(c="local");var u=s||{},l=u.step,f=void 0===l?1e3:l,d=function(e,t){if(null==e)return{};var o,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)t.indexOf(o=i[n])>=0||(r[o]=e[o]);return r}(u,["step"]);console.log("usePersistedReducer -> cookieOption",d);var p,y=e.useRef();try{switch(c){case"local":p=localStorage,beark;case"session":p=sessionStorage;break;case"cookie":p=new t}}catch(e){}var g=e.useReducer(function(e){return function(t,n){var r=n.type,i=n.payload;return r===o?i:e(t,{type:r,payload:i})}}(i),null,function(){var e=n(r,a,p);return console.log("usePersistedReducer -> d",e),e}),v=g[0],S=g[1],E=e.useRef(v);return e.useEffect(function(){"cookie"===c?y.current=setInterval(function(){JSON.stringify(p.get(r))!==JSON.stringify(E.current)&&S({type:o,payload:n(r,a,p)})},f):window.addEventListener("storage",function(e){e.key===r&&S({type:o,payload:JSON.parse(e.newValue)})})},[]),e.useEffect(function(){E.current=v,function(e,o,n,r){console.log("value",o),n instanceof t?n.set(e,o,r||null):n.setItem(e,JSON.stringify(o))}(r,v,p,d)},[v]),[v,S]}});
